<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="data:image/svg+xml,%3csvg width='32' height='32' viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3clinearGradient id='logoGradient' x1='0' y1='0' x2='32' y2='32'%3e%3cstop offset='0%25' stop-color='%2360a5fa' /%3e%3cstop offset='100%25' stop-color='%23a78bfa' /%3e%3c/linearGradient%3e%3c/defs%3e%3cpath d='M20 2H8C6.89543 2 6 2.89543 6 4V22H18C19.1046 22 20 21.1046 20 20V2Z' fill='url(%23logoGradient)' fill-opacity='0.6' /%3e%3cpath d='M24 10H12C10.8954 10 10 10.8954 10 12V30H22C23.1046 30 24 29.1046 24 28V10Z' fill='url(%23logoGradient)' /%3e%3c/svg%3e" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Duplisheets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SheetJS (xlsx) for Excel file parsing -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- PapaParse for CSV file parsing -->
    <script src="https://cdn.jsdelivr.net/npm/paparse@5.4.1/paparse.min.js"></script>
    <!-- jschardet for character encoding detection -->
    <script src="https://cdn.jsdelivr.net/npm/jschardet@3.0.0/dist/jschardet.min.js"></script>
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <!-- jsPDF for PDF exporting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <!-- JSZip for creating zip archives -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- fast-levenshtein for fuzzy matching -->
    <script src="https://cdn.jsdelivr.net/npm/fast-levenshtein@2.0.6/levenshtein.min.js"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap');

      body {
        font-family: 'Inter', sans-serif;
        background-color: #0a092d;
        background-image: radial-gradient(at 27% 37%, hsla(215, 98%, 61%, 0.1) 0px, transparent 50%),
                          radial-gradient(at 97% 21%, hsla(125, 98%, 72%, 0.1) 0px, transparent 50%),
                          radial-gradient(at 52% 99%, hsla(355, 98%, 76%, 0.1) 0px, transparent 50%),
                          radial-gradient(at 10% 29%, hsla(256, 96%, 68%, 0.1) 0px, transparent 50%),
                          radial-gradient(at 97% 96%, hsla(38, 60%, 74%, 0.1) 0px, transparent 50%),
                          radial-gradient(at 33% 50%, hsla(222, 67%, 73%, 0.1) 0px, transparent 50%),
                          radial-gradient(at 79% 53%, hsla(343, 68%, 79%, 0.1) 0px, transparent 50%);
        overflow: hidden;
      }

      /* Cursor Spotlight Effect */
      #cursor-spotlight {
        position: fixed;
        top: 0;
        left: 0;
        width: 400px;
        height: 400px;
        background: radial-gradient(circle, rgba(29, 78, 216, 0.15), transparent 60%);
        border-radius: 50%;
        pointer-events: none;
        transform: translate(-50%, -50%);
        transition: transform 0.1s ease-out, width 0.3s ease, height 0.3s ease;
        z-index: 9999;
      }

      /* Glassmorphism Classes */
      .glass-card {
        background: rgba(17, 24, 39, 0.4); /* Semi-transparent dark background */
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      }
      .glass-sidebar {
        background: rgba(10, 9, 45, 0.6);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-right: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      /* Modern Form Elements */
      .modern-toggle .peer:checked ~ .toggle-bg {
        background-color: #2563eb; /* Blue-600 */
        border-color: #2563eb;
      }
      
      .modern-toggle .peer:checked ~ .toggle-dot {
        transform: translateX(100%);
        background-color: white;
      }

      /* Gradient Text */
      .gradient-text {
        background: linear-gradient(to right, #60a5fa, #a78bfa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-fill-color: transparent;
      }
      
      /* Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      /* Dropdown option styling for dark mode */
      select option {
        background: #0f172a; /* Corresponds to slate-900 */
        color: #f9fafb;
      }
    </style>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
            colors: {
              border: "hsl(217 33% 17%)",
              input: "hsl(217 33% 17%)",
              ring: "hsl(222.2 84% 4.9%)",
              background: "#0a092d", // Deep blue
              foreground: "hsl(210 40% 98%)",
              primary: {
                DEFAULT: "#2563eb", // Blue-600
                foreground: "hsl(210 40% 98%)",
              },
              secondary: {
                DEFAULT: "rgba(255, 255, 255, 0.1)",
                foreground: "hsl(210 40% 98%)",
              },
              destructive: {
                DEFAULT: "#dc2626", // Red-600
                foreground: "hsl(210 40% 98%)",
              },
              muted: {
                DEFAULT: "hsl(217 33% 17%)",
                foreground: "hsl(215 20% 65%)",
              },
              accent: {
                DEFAULT: "hsl(217 33% 17%)",
                foreground: "hsl(210 40% 98%)",
              },
            },
            borderRadius: {
              lg: "0.75rem",
              md: "0.5rem",
              sm: "0.375rem",
            },
            keyframes: {
              "border-breathing": {
                '0%, 100%': { 'border-color': 'rgba(96, 165, 250, 0.4)' },
                '50%': { 'border-color': 'rgba(167, 139, 250, 0.8)' },
              },
              "slide-in": {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            },
            animation: {
              'border-breathing': 'border-breathing 4s ease-in-out infinite',
              'slide-in': 'slide-in 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards',
            }
          },
        },
      }
    </script>
  <script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.1.1/",
    "react": "https://esm.sh/react@^19.1.1",
    "react-dom/": "https://esm.sh/react-dom@^19.1.1/"
  }
}
</script>
</head>
  <body>
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    <script>
      const spotlight = document.createElement('div');
      spotlight.id = 'cursor-spotlight';
      document.body.appendChild(spotlight);

      document.addEventListener('mousemove', (e) => {
        spotlight.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`;
      });
    </script>
  </body>
</html>